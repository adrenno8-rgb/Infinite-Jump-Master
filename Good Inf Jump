local UserInputService = game:GetService("UserInputService")
local player = game.Players.LocalPlayer

local humanoid
local infiniteJump = false
local jumpBoost = false
local wallhop = false

local jumpPowerDefault = 50
local jumpPowerBoosted = 180

local jumpPressed = false
local guiButtons = {}

local function setupCharacter(character)
	humanoid = character:WaitForChild("Humanoid", 10)
end

if player.Character then
	setupCharacter(player.Character)
end
player.CharacterAdded:Connect(setupCharacter)

local function updateButtonTexts()
	if guiButtons.toggle then
		guiButtons.toggle.Text = infiniteJump and "Inf Jump: ON" or "Inf Jump: OFF"
		guiButtons.toggle.BackgroundColor3 = infiniteJump and Color3.fromRGB(0,150,0) or Color3.fromRGB(100,0,0)
	end
	if guiButtons.boost then
		guiButtons.boost.Text = jumpBoost and "JP Boost: ON" or "JP Boost: OFF"
		guiButtons.boost.BackgroundColor3 = jumpBoost and Color3.fromRGB(0,150,0) or Color3.fromRGB(100,0,0)
	end
	if guiButtons.wallhop then
		guiButtons.wallhop.Text = wallhop and "Wallhop: ON" or "Wallhop: OFF"
		guiButtons.wallhop.BackgroundColor3 = wallhop and Color3.fromRGB(0,150,0) or Color3.fromRGB(100,0,0)
	end
end

UserInputService.InputBegan:Connect(function(input, processed)
	if processed then return end
	if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.Space then
		if not jumpPressed then
			jumpPressed = true
			if infiniteJump and humanoid then
				local state = humanoid:GetState()
				if state == Enum.HumanoidStateType.Running or state == Enum.HumanoidStateType.Landed 
				or state == Enum.HumanoidStateType.Freefall or state == Enum.HumanoidStateType.Physics then
					humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
					humanoid.Jump = true
					if wallhop and humanoid.RootPart then
						humanoid.RootPart.CFrame = humanoid.RootPart.CFrame * CFrame.Angles(0, math.rad(85), 0)
					end
				end
			end
		end
	end
	if input.KeyCode == Enum.KeyCode.U then
		infiniteJump = not infiniteJump
		updateButtonTexts()
	elseif input.KeyCode == Enum.KeyCode.Q then
		jumpBoost = not jumpBoost
		if humanoid then
			humanoid.JumpPower = jumpBoost and jumpPowerBoosted or jumpPowerDefault
		end
		updateButtonTexts()
	elseif input.KeyCode == Enum.KeyCode.E then
		wallhop = not wallhop
		updateButtonTexts()
	end
end)

UserInputService.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.Space then
		jumpPressed = false
	end
end)

local function createMenu()
	local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
	gui.Name = "InfiniteBoostMenu"

	local frame = Instance.new("Frame", gui)
	frame.Size = UDim2.new(0, 160, 0, 160)
	frame.Position = UDim2.new(0.5, -80, 0.5, -80)
	frame.BackgroundColor3 = Color3.fromRGB(35,35,35)

	local title = Instance.new("TextLabel", frame)
	title.Size = UDim2.new(1, 0, 0, 28)
	title.Position = UDim2.new(0, 0, 0, 10)
	title.Text = "Infinite Boost"
	title.TextColor3 = Color3.fromRGB(255,255,255)
	title.TextScaled = true
	title.Font = Enum.Font.SourceSansBold
	title.BackgroundTransparency = 1

	local function createButton(text, yPos, callback)
		local btn = Instance.new("TextButton", frame)
		btn.Size = UDim2.new(0, 140, 0, 25)
		btn.Position = UDim2.new(0, 10, 0, yPos)
		btn.Text = text
		btn.TextColor3 = Color3.fromRGB(255,255,255)
		btn.BackgroundColor3 = Color3.fromRGB(100,0,0)
		btn.Font = Enum.Font.Gotham
		btn.TextSize = 14
		btn.MouseButton1Click:Connect(callback)
		return btn
	end

	guiButtons.toggle = createButton("Inf Jump: OFF", 50, function()
		infiniteJump = not infiniteJump
		updateButtonTexts()
	end)

	guiButtons.boost = createButton("JP Boost: OFF", 80, function()
		jumpBoost = not jumpBoost
		if humanoid then
			humanoid.JumpPower = jumpBoost and jumpPowerBoosted or jumpPowerDefault
		end
		updateButtonTexts()
	end)

	guiButtons.wallhop = createButton("Wallhop: OFF", 110, function()
		wallhop = not wallhop
		updateButtonTexts()
	end)

	local closeBtn = Instance.new("TextButton", frame)
	closeBtn.Size = UDim2.new(0, 6, 0, 6)
	closeBtn.Position = UDim2.new(1, -10, 0, 4)
	closeBtn.Text = "X"
	closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
	closeBtn.TextSize = 10
	closeBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
	closeBtn.Font = Enum.Font.SourceSansBold
	closeBtn.MouseButton1Click:Connect(function()
		gui:Destroy()
	end)

	local minimizeBtn = Instance.new("TextButton", frame)
	minimizeBtn.Size = UDim2.new(0, 6, 0, 6)
	minimizeBtn.Position = UDim2.new(1, -20, 0, 4)
	minimizeBtn.Text = "â€”"
	minimizeBtn.TextColor3 = Color3.fromRGB(255,255,255)
	minimizeBtn.TextSize = 10
	minimizeBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
	minimizeBtn.Font = Enum.Font.GothamBold

	local minimized = false
	minimizeBtn.MouseButton1Click:Connect(function()
		minimized = not minimized
		guiButtons.toggle.Visible = not minimized
		guiButtons.boost.Visible = not minimized
		guiButtons.wallhop.Visible = not minimized
		frame.Size = minimized and UDim2.new(0,160,0,40) or UDim2.new(0,160,0,160)
	end)

	local dragStart, startPos
	frame.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragStart = input.Position
			startPos = frame.Position
		end
	end)
	frame.InputChanged:Connect(function(input)
		if dragStart and input.UserInputType == Enum.UserInputType.MouseMovement then
			local delta = input.Position - dragStart
			frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end)
	frame.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragStart = nil
		end
	end)
end

createMenu()

player.CharacterAdded:Connect(function()
	local existing = player.PlayerGui:FindFirstChild("InfiniteBoostMenu")
	if existing then existing:Destroy() end
	createMenu()
end)

